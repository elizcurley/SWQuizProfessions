<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Social Work Path Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="A quick, configurable quiz to help new social work students explore practice pathways (clinical, school, medical, policy, research, etc.)." />
  <style>
    @media print {
      #app { box-shadow: none !important; }
      .no-print { display: none !important; }
      .print-only { display: block !important; }
    }
    .print-only { display: none; }
  </style>
</head>
<body class="bg-slate-50 text-slate-900">
  <main id="app" class="mx-auto max-w-4xl p-6 md:p-10">
    <!-- Header -->
    <header class="mb-6">
      <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">Find Your Social Work Path</h1>
      <p class="mt-2 text-slate-600 max-w-2xl">A quick, low-stakes tool to help you explore where you might thrive in social work: clinical, school, community, policy, research/evaluation, health/medical, child & family, or justice/forensic. Your answers aren’t destiny—they’re a conversation starter.</p>
    </header>

    <!-- Card container -->
    <section class="rounded-2xl bg-white shadow-lg ring-1 ring-black/5 overflow-hidden">
      <!-- Progress Bar -->
      <div id="progressWrap" class="w-full bg-slate-100 h-2">
        <div id="progressBar" class="h-2 bg-sky-500 transition-all" style="width:0%"></div>
      </div>

      <!-- Content -->
      <div id="content" class="p-6 md:p-8"></div>
    </section>

    <noscript>
      <div class="mt-4 rounded-xl bg-rose-50 text-rose-700 p-4">
        JavaScript is disabled. Enable it to use the quiz.
      </div>
    </noscript>

    <!-- Footer actions -->
    <div class="mt-6 flex flex-wrap gap-3">
      <button id="printBtn" class="no-print inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium hover:bg-slate-50" title="Print or save as PDF">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9V2h12v7"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><path d="M6 14h12v8H6z"/></svg>
        Print / Save PDF
      </button>
      <button id="resetBtn" class="no-print inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium hover:bg-slate-50" title="Clear saved progress">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/><path d="M21 3v9h-9"/></svg>
        Reset
      </button>
      <button id="copyBtn" class="no-print inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium hover:bg-slate-50" title="Copy result summary">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
        Copy results
      </button>
    </div>

    <!-- Small deployment note (hidden on print) -->
    <p class="no-print mt-4 text-xs text-slate-500">Deploy by dropping this <code>index.html</code> into a public GitHub repo and enabling GitHub Pages (Settings → Pages → deploy from <em>main</em>).</p>
  </main>

  <script>
    // Robust init: wait for DOM ready; capture errors to show a visible message instead of a blank card
    window.addEventListener('DOMContentLoaded', () => {
      const fatal = (err) => {
        try {
          let slot = document.getElementById('content');
          if (!slot) {
            slot = document.createElement('div');
            slot.id = 'content';
            (document.querySelector('section') || document.body).appendChild(slot);
          }
          slot.innerHTML = `
            <div class="rounded-xl border border-rose-200 bg-rose-50 p-4 text-rose-800">
              <p class="font-semibold">The quiz script hit an error.</p>
              <p class="mt-1 text-sm">Open your browser console and share the red message with me. In the meantime, try a hard refresh (Ctrl/Cmd+Shift+R).</p>
            </div>`;
        } catch {}
        console.error('[SW Quiz] Fatal error:', err);
      };

      try {
        /** CONFIG & DATA **/
        const STORAGE_KEY = 'sw-path-quiz-v1';
        const PATHWAYS = [
          { id: 'clinical', name: 'Clinical / Therapy', blurb: 'One-on-one and small-group counseling, assessment, treatment planning, crisis intervention.', courses: ['Clinical Practice I/II', 'Psychopathology/Assessment', 'Trauma-Informed Practice'], practicum: ['Outpatient mental health clinic', 'Hospital psych unit', 'College counseling'] },
          { id: 'school',   name: 'School Social Work', blurb: 'Supporting students, families, and educators; MTSS/RTI, attendance, and IEP collaboration.', courses: ['School Social Work', 'Child & Adolescent Practice', 'Family Systems'], practicum: ['K–12 schools', 'Alternative education programs', 'After-school programs'] },
          { id: 'medical',  name: 'Health / Medical Social Work', blurb: 'Hospitals, clinics, care transitions, interdisciplinary teams, discharge planning.', courses: ['Health/Meds SW', 'Integrated Care', 'Motivational Interviewing'], practicum: ['Medical-surgical unit', 'Primary care clinic', 'Oncology/NICU'] },
          { id: 'childfam', name: 'Child & Family Welfare', blurb: 'Safety, permanency, wellbeing; prevention, family preservation, foster/kinship support.', courses: ['Child Welfare', 'Family Systems', 'Trauma & Resilience'], practicum: ['CPS/child welfare services', 'Family resource centers', 'Prevention programs'] },
          { id: 'community',name: 'Community Organizing & Program Development', blurb: 'Coalition building, outreach, program design/management, fundraising and partnerships.', courses: ['Macro Practice', 'Program Planning', 'Community Organizing'], practicum: ['Community-based nonprofits', 'Neighborhood initiatives', 'Mutual aid orgs'] },
          { id: 'policy',   name: 'Policy & Advocacy', blurb: 'Legislative advocacy, policy analysis, systems design, coalition politics.', courses: ['Policy Analysis', 'Advocacy & Lobbying', 'Economics of Social Policy'], practicum: ['Legislative offices', 'Policy think tanks', 'Advocacy coalitions'] },
          { id: 'research', name: 'Research & Program Evaluation', blurb: 'Study design, measurement, implementation science, data visualization and reporting.', courses: ['Research Methods', 'Program Evaluation', 'Data Analysis/Stats'], practicum: ['Research centers', 'Evaluation firms', 'University labs'] },
          { id: 'justice',  name: 'Justice / Forensic Social Work', blurb: 'Courts, reentry, probation, corrections; mitigation, diversion, and family support.', courses: ['Forensic/Justice SW', 'Substance Use & Recovery', 'Trauma-Informed Systems'], practicum: ['Public defender/mitigation teams', 'Reentry programs', 'Problem-solving courts'] },
        ];

        const QUESTIONS = [
          { id: 'q1',  text: 'Meaningful impact for me looks like growth in an individual or small team.' },
          { id: 'q2',  text: 'I’m motivated by shifting systems, policies, or resource flows.' },
          { id: 'q3',  text: 'I enjoy translating complex information so others can act on it.' },
          { id: 'q4',  text: 'I like facilitating groups to align and move in the same direction.' },
          { id: 'q5',  text: 'Fast-paced, time‑sensitive situations bring out my focus.' },
          { id: 'q6',  text: 'I’m drawn to work that navigates rights, ethics, and accountability.' },
          { id: 'q7',  text: 'Clear measures and data I can track over time keep me motivated.' },
          { id: 'q8',  text: 'I prefer varied, mobile days over primarily desk‑based work.' },
          { id: 'q9',  text: 'I value continuity and long‑term relationships over quick turnarounds.' },
          { id: 'q10', text: 'Building programs or processes from scratch energizes me.' },
          { id: 'q11', text: 'I’d rather design systems than provide day‑to‑day direct services.' },
          { id: 'q12', text: 'Learning and development environments feel like home to me.' },
          { id: 'q13', text: 'Health and wellbeing contexts feel especially meaningful to me.' },
          { id: 'q14', text: 'Supporting safety and stability for children and families is a priority for me.' },
          { id: 'q15', text: 'I’m comfortable engaging with laws, courts, or formal accountability.' },
          { id: 'q16', text: 'I like convening diverse stakeholders to co‑create solutions.' },
          { id: 'q17', text: 'Reducing systemic inequities is a central motivation for my work.' },
          { id: 'q18', text: 'I prefer predictable routines and calendars over constant novelty.' },
        ];

        const WEIGHTS = {
          clinical: { q1: 2,  q2: -1, q3: 1,  q4: 0,  q5: 1,  q6: 1,  q7: 0,  q8: 0,  q9: 2,  q10: 0, q11: -1, q12: 1,  q13: 1,  q14: 1,  q15: 0,  q16: 0,  q17: 1,  q18: 1 },
          school:   { q1: 1,  q2: 0,  q3: 1,  q4: 1,  q5: 0,  q6: 0,  q7: 0,  q8: 0,  q9: 2,  q10: 0, q11: 0,  q12: 2,  q13: 0,  q14: 1,  q15: 0,  q16: 1,  q17: 1,  q18: 2 },
          medical:  { q1: 1,  q2: 0,  q3: 0,  q4: 0,  q5: 2,  q6: 0,  q7: 1,  q8: 1,  q9: 0,  q10: 1, q11: 0,  q12: 0,  q13: 2,  q14: 0,  q15: 0,  q16: 0,  q17: 0,  q18: -1 },
          childfam: { q1: 1,  q2: 0,  q3: 0,  q4: 1,  q5: 1,  q6: 1,  q7: 0,  q8: 1,  q9: 1,  q10: 0, q11: 0,  q12: 1,  q13: 0,  q14: 2,  q15: 1,  q16: 1,  q17: 1,  q18: 1 },
          community:{ q1: 0,  q2: 2,  q3: 1,  q4: 2,  q5: 1,  q6: 0,  q7: 0,  q8: 2,  q9: 0,  q10: 2, q11: 1,  q12: 0,  q13: 0,  q14: 1,  q15: 0,  q16: 2,  q17: 2,  q18: -1 },
          policy:   { q1: -1, q2: 2,  q3: 2,  q4: 1,  q5: 0,  q6: 1,  q7: 1,  q8: 0,  q9: 0,  q10: 1, q11: 2,  q12: 0,  q13: 0,  q14: 0,  q15: 2,  q16: 2,  q17: 2,  q18: 0 },
          research: { q1: -1, q2: 1,  q3: 2,  q4: 0,  q5: 0,  q6: 0,  q7: 2,  q8: -1, q9: 2,  q10: 1, q11: 2,  q12: 1,  q13: 0,  q14: 0,  q15: 0,  q16: 1,  q17: 1,  q18: 1 },
          justice:  { q1: 0,  q2: 1,  q3: 1,  q4: 0,  q5: 1,  q6: 2,  q7: 0,  q8: 1,  q9: 0,  q10: 1, q11: 0,  q12: 0,  q13: 0,  q14: 1,  q15: 2,  q16: 1,  q17: 2,  q18: -1 },
        };

        /** STATE **/
        let answers = loadAnswers();
        let step = loadStep();

        /** RENDER **/
        function render() {
          updateProgress();
          const slot = ensureSlot();
          slot.innerHTML = '';
          if (step === 0) slot.appendChild(renderIntro());
          else if (step >= 1 && step <= QUESTIONS.length) slot.appendChild(renderQuestion(step));
          else slot.appendChild(renderResults());
        }

        function ensureSlot() {
          let slot = document.getElementById('content');
          if (!slot) {
            slot = document.createElement('div');
            slot.id = 'content';
            slot.className = 'p-6 md:p-8';
            (document.querySelector('section') || document.body).appendChild(slot);
          }
          return slot;
        }

        function renderIntro() {
          const el = document.createElement('div');
          el.innerHTML = `
            <div class="flex flex-col gap-4">
              <p class="text-slate-700">These prompts focus on values, pace, and working conditions—not specific settings or skills. Answer for what sounds energizing, even if it’s new to you.</p>
              <ul class="list-disc pl-6 text-slate-600 space-y-1">
                <li>No logins. Your progress saves locally.</li>
                <li>You can skip questions and come back.</li>
                <li>Results can be printed or saved as PDF.</li>
              </ul>
              <div class="mt-2 flex items-center gap-3">
                <button id="startBtn" class="rounded-2xl bg-sky-600 text-white px-5 py-3 text-sm font-semibold shadow hover:bg-sky-700">Start quiz</button>
                <button id="jumpResultsBtn" class="text-sky-700 underline underline-offset-2">See last saved results</button>
              </div>
            </div>`;
          el.querySelector('#startBtn')?.addEventListener('click', () => setStep(1));
          el.querySelector('#jumpResultsBtn')?.addEventListener('click', () => setStep(QUESTIONS.length + 1));
          return el;
        }

        function renderQuestion(idx) {
          const q = QUESTIONS[idx - 1];
          const el = document.createElement('div');
          const val = answers[q.id] ?? null;
          el.innerHTML = `
            <div class="flex flex-col gap-6">
              <div>
                <p class="text-xs uppercase tracking-wide text-slate-500">Question ${idx} of ${QUESTIONS.length}</p>
                <h2 class="mt-1 text-2xl font-bold">${q.text}</h2>
              </div>
              <fieldset class="space-y-3" aria-label="Likert scale from 1 to 5">${renderLikert(q.id, val)}</fieldset>
              <div class="flex flex-wrap items-center gap-3">
                <button class="rounded-xl bg-sky-600 text-white px-4 py-2 text-sm font-semibold hover:bg-sky-700" id="nextBtn">${idx === QUESTIONS.length ? 'Finish' : 'Next'}</button>
                <button class="rounded-xl bg-white border border-slate-200 px-4 py-2 text-sm font-medium hover:bg-slate-50" id="skipBtn">Skip</button>
                <button class="rounded-xl bg-white border border-slate-200 px-4 py-2 text-sm font-medium hover:bg-slate-50" id="prevBtn">Back</button>
              </div>
            </div>`;
          el.querySelector('#nextBtn')?.addEventListener('click', () => setStep(idx === QUESTIONS.length ? QUESTIONS.length + 1 : idx + 1));
          el.querySelector('#skipBtn')?.addEventListener('click', () => setStep(idx === QUESTIONS.length ? QUESTIONS.length + 1 : idx + 1));
          el.querySelector('#prevBtn')?.addEventListener('click', () => setStep(Math.max(0, idx - 1)));
          return el;
        }

        function renderLikert(qid, currentVal) {
          const labels = ['1 Strongly Disagree','2','3','4','5 Strongly Agree'];
          return labels.map((label, i) => {
            const val = i + 1;
            const checked = currentVal === val ? 'checked' : '';
            return `
              <label class="flex items-center gap-3 rounded-xl border border-slate-200 p-3 cursor-pointer hover:bg-slate-50">
                <input type="radio" name="${qid}" value="${val}" ${checked} class="h-4 w-4" />
                <span class="text-sm">${label}</span>
              </label>`;
          }).join('');
        }

        function renderResults() {
          const { scores, ranked, answeredCount } = scorePaths();
          const el = document.createElement('div');
          const answeredNote = answeredCount === 0
            ? '<p class="text-sm text-rose-600">You skipped everything—results are empty. Go back and answer a few!</p>'
            : `<p class="text-sm text-slate-500">Based on <strong>${answeredCount}</strong> answered item${answeredCount===1?'':'s'}. You can change answers and results will update.</p>`;
          const bars = ranked.map(({ id, pct }) => {
            const p = PATHWAYS.find(p => p.id === id);
            const w = Math.round(pct);
            return `
              <div class="space-y-1">
                <div class="flex items-center justify-between text-sm"><span class="font-medium">${p.name}</span><span class="tabular-nums">${w}%</span></div>
                <div class="w-full bg-slate-100 rounded-full h-3 overflow-hidden"><div class="h-3 bg-sky-500" style="width:${w}%"></div></div>
              </div>`;
          }).join('');
          const top3 = ranked.slice(0, 3).map(({ id, pct }) => {
            const p = PATHWAYS.find(p => p.id === id);
            return renderPathwayCard(p, Math.round(pct));
          }).join('');
          el.innerHTML = `
            <div class="flex flex-col gap-6">
              <div><h2 class="text-2xl font-bold">Your Results</h2>${answeredNote}</div>
              <div class="grid gap-4">${bars}</div>
              <div class="mt-4"><h3 class="text-xl font-semibold">Your Top Matches</h3><div class="mt-3 grid gap-4 md:grid-cols-2">${top3}</div></div>
              <div class="mt-2 text-xs text-slate-500"><p><span class="font-semibold">How this works:</span> We center each 1–5 answer to -2..+2 and apply a weight matrix to each pathway. Normalized scores are scaled to 0–100 across your answered items. This is a reflection tool—not a gatekeeper.</p></div>
              <div class="no-print mt-4 flex items-center gap-3">
                <button class="rounded-xl bg-sky-600 text-white px-4 py-2 text-sm font-semibold hover:bg-sky-700" id="editBtn">Edit answers</button>
                <button class="rounded-xl bg-white border border-slate-200 px-4 py-2 text-sm font-medium hover:bg-slate-50" id="retakeBtn">Retake</button>
              </div>
            </div>`;
          el.querySelector('#editBtn')?.addEventListener('click', () => setStep(1));
          el.querySelector('#retakeBtn')?.addEventListener('click', () => { answers = {}; persistAnswers(); setStep(1); });
          return el;
        }

        function renderPathwayCard(p, pct) {
          const courseList = p.courses.map(c => `<li>${c}</li>`).join('');
          const pracList = p.practicum.ma
</body>
</html>
